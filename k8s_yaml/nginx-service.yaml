# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: nginx-loadbalancer
spec:
  selector:
    app: nginx # Matches the 'app: nginx' label on the Pods
  type: LoadBalancer # THIS is what creates the external L4 Load Balancer on GKE
  # THIS FIELD ATTACHES THE RESERVED IP
  # loadBalancerIP: 34.154.104.247
  ports:
    - name: http           
      protocol: TCP
      port: 80       # The port clients will use to reach the Load Balancer (external port)
      targetPort: 80 # The port the Pods are listening on (containerPort)
    - name: https    
      protocol: TCP
      port: 443
      targetPort: 443

  # --- Access Restriction Field ---
  loadBalancerSourceRanges:
  - "192.168.1.0/24"   # Allows the entire 192.168.1.x network
  - "172.16.10.0/28"   # Allows a smaller, specific subnet
